!function(e){var t={};function n(l){if(t[l])return t[l].exports;var a=t[l]={i:l,l:!1,exports:{}};return e[l].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(l,a,function(t){return e[t]}.bind(null,a));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="dist",n(n.s=1)}([function(e){e.exports={ka:{alias:"ქართული",time:"დრო",day:"დღე",sugars:"შაქრები",doses_table_head:"ინექციების ცხრილი",languages_head:"ენები",blood_type_head:"გლუკოზის ანალიზის ტიპი",auto_save_head:"ავტომატური მონაცემების შენახვა",set_date_head:"მიუთითეთ თარიღი და დღეების რაოდენობა",sort_time_head:"დროის დახარისხება და სვეტის წაშლა",insulins_use_head:"გამოიყენებადი ინსულინები ",warning_head:"გაფრთხილება",auto_save_label:"ავტომატური შენახვა",doses_link:"დოზები",warning_link:"გადადით აქ",info:"აქ შეგიძლიათ: დაამატოთ დოზები, წაშალოთ ისინი, შეცვალოთ ისინი; დაამატოთ დრო, წაშალოთ და შეცვალეთ იგი; თქვენ ასევე შეგიძლიათ დაამატოთ ან წაშალოთ ინსულინი , რომელოს ტქვენ  გჭირდებათ. ყურადღება: ექიმთან კონსულტაციის გარეშე, არ შეასრულოთ ეს მანიპულაციები, წინააღმდეგ შემთხვევაში შეიძლება ზიანი მიაყენოს თქვენს ჯანმრთელობას",warning_text:"გამარჯობა, ახალო მომხმარებელო, მოგესალმები! რადგან ახალი მომხმარებელი ხართ, და ჯერ-ჯერობით არ გაქვთ თქვენი დოზების ცხრილი, ამიტომ პირველ რიგში უნდა შექმნათ იგი , მხოლოდ მერე გადმოხვიდეთ აქ.",buttons:{save_btn:"მონაცემების შენახვა",load_btn:"ჩამოტვირთეთ მონაცემები",info_btn:"პარამეტრები",print:"დაბეჭვდა",submit_btn:"გაგზავნა",addInsulin_btn:"ინსულინის დამატება"},messages:{deleteColumn:"ნამდვილად გსურთ წაშალოთ სვეტი?",deleteFromColumn:"ნამდვილად გსურთ ამ სვეტიდან %_% წაშლა?",deleteInsulin:"ნამდვილად გინდათ %_% წაშლა?",deleted:"%_% წარმატებით წაიშალა!",setTheTime:"დაადგინეთ დრო, უპირველეს ყოვლისა",selectInsType:"აირჩიეთ ინსულინის ტიპი!",invalidValue:"არასწორი მნიშვნელობა!",exist:"%_% უკვე არსებობს!"}},ru:{alias:"Русский",time:"Время",day:"День",sugars:"Сахара",doses_table_head:"Таблица доз",languages_head:"Языки",blood_type_head:"Тип анализа глюкозы крови",auto_save_head:"Автоматическое сохранение данных",set_date_head:"Укажите дату и количество дней",sort_time_head:"Сортировка времени и удаление столбца",insulins_use_head:"Используемые инсулины",warning_head:"Предупреждение!",auto_save_label:"Автосохранение",doses_link:"Дозы",warning_link:"Передите сюда",info:"Здесь вы можете: добавлять дозы, удалять их, заменять; добавить время, а также удалить и изменить его; вы также можете добавить или удалить необходимый вам инсулин. Внимание: не консультируясь с врачом, не выполняйте эти манипуляции самостоятельно, иначе это может нанести ущерб вашему здоровью",warning_text:"Привет, новый пользователь, добро пожаловать! Поскольку вы новый пользователь, вы еще не создали свою таблицу доз, так что прежде всего создайте таблицу ваших доз, а затем вернитесь сюда.",buttons:{save_btn:"Сохранить данные",load_btn:"Загрузить данные",info_btn:"Опции",print:"Распечатать",submit_btn:"Отправить",addInsulin_btn:"Добавить инсулин"},messages:{deleteColumn:"Вы уверены, что хотите удалить столбец ?",deleteFromColumn:"Вы действительно хотите удалить %_% из этой колонки ?",deleteInsulin:"Вы действительно хотите удалить %_%?",deleted:"%_% удален успешно!",setTheTime:"Установите время, в первую очередь",selectInsType:"Выберите тип инсулина!",invalidValue:"Неверное значение!",exist:"%_% уже существует!"}},en:{alias:"English",time:"Time",day:"Day",sugars:"Sugars",doses_table_head:"Doses table",languages_head:"Languages",blood_type_head:"Blood glucose type",auto_save_head:"Auto save data",set_date_head:"Set date and count of day",sort_time_head:"Sorting the time and deleting the column",insulins_use_head:"Insulins in use",warning_head:"Warning!",auto_save_label:"Save data",doses_link:"Doses",warning_link:"Go here",info:"Here you can: add doses, remove them, replace them; add time, also delete and change it; you can also add or remove the insulin you need. Attention: without consulting a doctor, do not perform these manipulations yourself, otherwise it can be detrimental to your health ",warning_text:"Hello, new user, welcome! Since you are a new user, you have not yet created your dose chart, so first of all create a table of your doses, and then go back here.",buttons:{save_btn:"Save data",load_btn:"Load data",info_btn:"Options",print:"Print",submit_btn:"Submit",addInsulin_btn:"Add insulin"},messages:{deleteColumn:"Are you sure you want delete column ?",deleteFromColumn:"Do you really want to remove %_% from this column ?",deleteInsulin:"Do you really want to remove %_%?",deleted:"%_% was deleted successfully!",setTheTime:"Set the time , first of all",selectInsType:"Select a insulin type!",invalidValue:"Invalid value!",exist:"%_% already exists!"}}}},function(e,t,n){n(2),e.exports=n(3)},function(e,t,n){"use strict";n.r(t);var l=n(0);var a={setCookie(e,t,n){var l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3);var a="expires="+l.toUTCString();document.cookie=e+"="+t+";"+a+";path=/"},getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),l=0;l<n.length;l++){for(var a=n[l];" "==a.charAt(0);)a=a.substring(1);if(0==a.indexOf(t))return a.substring(t.length,a.length)}return null},insertAfter(e,t){t.parentNode.insertBefore(e,t.nextSibling)},isArray:e=>"[object Array]"===Object.prototype.toString.call(e),insertInput(e,t){e.innerHTML=`<input class="ins_field" maxlength="5" value=${t||0} "/>`},insertInputWithSelect(e,t,n){let l=this.lsGet("insulins"),a=Number(t)||0,s=null,i=void 0!==n?`<button class="delete_dose" data-type="${n}">Delete</button>`:"";return l.forEach(e=>{return s+=`<option value=${e} ${n===e?"selected":""}>${this.capitalize(e)}</option>`}),e.innerHTML=`<div class="inp_group">\n      <input type="text" class="ins_value_field" value="${a}">\n        <select name="insulins_type" multiple size="2">\n          <option value="insulins" disabled>Insulins</option>\n          ${s}\n        </select>\n        ${i}\n    </div>`},insertInputAndSelect(e){let{childCount:t,doseField:n,doseValue:l,doseType:a,insulins:s}=e,i=l?Number(l):0,o=t>1?"":' <option value="*">All</option>',r=t>1?'<button class="delete_dose">Delete</button>':"",d="";s.forEach(e=>{d+=`<option value="${e}" ${e==a?"selected":""} ${0===t?"":e==a?"":"disabled"} >${this.capitalize(e)}</option>`}),n.innerHTML=`<div class="inp_group">\n      <input type="text" class="ins_field" value="${i}">\n        <select name="insulins_type" >\n          <option value="insulins" disabled>Insulins</option>\n          ${o}\n          ${d}\n        </select>\n        ${r}\n    </div>`},print(e){e.addEventListener("click",()=>{document.querySelectorAll("button").forEach(e=>e.classList.add("hide")),document.querySelectorAll("select").forEach(e=>e.classList.add("hide")),window.print()})},reset(){window.onafterprint=(()=>{document.querySelectorAll("button").forEach(e=>e.classList.remove("hide")),document.querySelectorAll("select").forEach(e=>e.classList.remove("hide"))})},capitalize:e=>e[0].toUpperCase()+e.slice(1),handler(e,t=!0,n=2500){let l=document.querySelector(".error")||document.querySelector("success")?null:document.createElement("div");l&&(l.className=t?"error":"success",l.textContent=e,this.parentNode.insertBefore(l,this.nextSibling),setTimeout(()=>l.remove(),n))},createModal(e){const t=`<div class="modal" style="display:flex">\n        <div class="modal-content warning">\n            <h1 class="${e}_head"></h1>\n            <p class="${e}_text"></p>\n            <a href="./doses.html" class="${e}_link"></a>\n        </div >\n    </div >`;return document.body.innerHTML+=t,this.translate()},translate(e){const t=l[e||this.getCookie("_lang")||"en"],n=Object.keys(t);return this.isArray(n)&&0!==n.length&&n.forEach(e=>{if("buttons"===e){let e=t.buttons;Object.keys(e).forEach(t=>{let n=document.querySelector(`button.${t}`);n&&(n.textContent=e[t])})}else if("messages"!==e){let n=document.querySelector(`.${e}`);n&&(n.innerHTML=t[e])}}),document.querySelector("html").lang=e||this.getCookie("_lang")},async getAllDocs(e,t){let n=[],l="Doses"===t?e.collection(t).orderBy("index","asc"):e.collection(t);return await l.get().then(e=>e.docs.forEach(e=>n.push(e.id))),n},lsGet:e=>JSON.parse(localStorage.getItem(e)),lsSet:(e,t)=>localStorage.setItem(e,JSON.stringify(t)),once(e,t){let n;return function(...l){return e&&(n=e.apply(t||this,l),e=null),n}}};var s={ka:["იან","თებ","მარ","აპრ","მაი","ივნ","ივლ","აგვ","სექ","ოქტ","ნოე","დეკ"],ru:["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],en:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]};var i=class{constructor(){this.date=new Date,this.now=null,this.sDate=null}getNow(){const e=this.date.getMonth()+1,t=this.date.getDate()+1,n=this.date.getFullYear();return this.now=new Date(`${e} ${t},${n}`),this.now}setDate(e=this.now){return this.sDate=new Date(e),this.sDate}getPrevDay(){let e=a.getCookie("_lang"),t=this.now||this.date;t.setDate(t.getDate()-1),this.setDate(t);let n=this.sDate.getDate(),l=s[e||"ka"][this.sDate.getMonth()];return this.sDate=`${n} ${l}`,this.sDate}setFromTo(e,t){let n=a.getCookie("_lang");const l=new Date(e),i=l.getMonth();let o=[];o.push({day:l.getDate(),month:s[n][i]});for(let e=0;e<t;e++)l.setDate(l.getDate()+1),o.push({day:l.getDate(),month:s[n][l.getMonth()]});return o}changeLang(){let e=document.querySelectorAll(".data"),t=a.getCookie("_lang");0!==e.length&&e.forEach(e=>{let n=e.firstChild,l=n.getAttribute("data-lang"),a=n.textContent.split(" "),i=a[0],o=a[1];if(t!==l){let e=s[l].indexOf(o);n.textContent=`${i} ${s[t][e]}`,n.setAttribute("data-lang",t)}})}};if(location.pathname.endsWith("doses.html")){!function(){a.lsGet("doses")||a.lsSet("doses",{}),a.lsGet("insulins")||a.lsSet("insulins",[]);const e=Object.keys(a.lsGet("doses")),t=a.lsGet("insulins");e.forEach(e=>(o(e),u(e))),t.forEach(e=>r(e)),0===t.length&&document.querySelector("#new_column").setAttribute("disabled","disabled"),a.translate()}();const e=document.querySelector("#new_column"),t=document.querySelector("#insulin_add_form"),n=document.querySelector("table"),s=a.getCookie("_lang")||"en",i=l[s].messages,C=[60,100,130,160,190,220,250,280,310,340,370,400,430],x=[99,129,159,189,219,249,279,309,339,369,399,429,460];function o(e){const t=`<div class="empty">\n          <div class="fill" draggable="true">${e}</div>\n        </div>`;document.querySelector(".row").innerHTML+=t}function r(e){let t=document.createElement("li");return t.className="insulins_list_item",t.dataset.type=e,t.textContent=a.capitalize(e),t.addEventListener("click",d),document.querySelector("#insulins_list").appendChild(t)}function d(t){let n=t.target.dataset.type,l=a.lsGet("insulins"),s=a.lsGet("times"),o=a.lsGet("doses"),r=i.deleteInsulin.replace("%_%",n),d=i.deleted.replace("%_%",n);if(l.includes(n)&&confirm(r)){s&&s.forEach((e,t)=>{void 0!==o[e][n]&&(delete o[e][n],0===Object.keys(o[e]).length&&(delete o[e],s.splice(t,1),y(e,t),a.lsSet("times",s)),document.querySelectorAll(`.ins_type[data-type="${n}"]`).forEach(e=>e.remove()),a.lsSet("doses",o))});let i=l.indexOf(n);return l.splice(i,1),a.lsSet("insulins",l),t.target.remove(),0===l.length&&e.setAttribute("disabled","disabled"),a.handler.call(document.querySelector("#insulin_add_form"),d,!1)}}function u(e){const t=document.querySelectorAll(".sugars_res"),n=document.createElement("th");n.addEventListener("click",_),function(e,t){if(e.className="inj_time",t&&(e.dataset.time=t),document.querySelector(".doses_row").appendChild(e),t)return e.textContent=t;a.insertInput(e,"0:00"),v(e.firstChild)}(n,"string"==typeof e?e:null),t.forEach((t,n)=>{let l=document.createElement("td"),s=a.lsGet("doses");if(l.dataset.index=document.querySelectorAll(".inj_time").length-1,l.className="doses","string"==typeof e){let t=Object.keys(s[e]);0===Object.keys(s[e]).length&&(a.insertInputWithSelect(l),c(l)),t.forEach(t=>{let a=h(s[e][t][n].dose,t,e);l.innerHTML+=a})}else a.insertInputWithSelect(l),c(l);return t.appendChild(l)})}function c(e){(e.firstChild.childNodes[1]||e.childNodes[1]).addEventListener("keyup",m)}function m(e){let t=e.target||e,n=t.parentNode.parentNode,l=n.parentNode.dataset.index,s=t.value,o=n.dataset.index,r=document.querySelectorAll(".inj_time")[o],d=t.nextElementSibling,u=Array.from(d.selectedOptions).map(e=>e.value),c=a.lsGet("insulins").reduce(e=>e+="\\d{1,2}(\\s+)",""),m=r.dataset.time,p=new RegExp(`^${c}?$`),f=13===e.which,g=27===e.which,y="";if(void 0===m)return alert(i.setTheTime);if(/^\d{1,2}$/.test(s)&&f||p.test(s)&&f){if(0===u.length)return alert(i.selectInsType);u.forEach((e,t)=>{let n=s.split(" ");n[t]=void 0===n[t]?n[0]:n[t],u.length>1?y+=h(Number(n[t]),e,m):y=h(Number(n[t]),e,m),function(e,t,n,l){let s=a.lsGet("doses"),i=s[l]||{},o=i[t]||[];0!==o.length?o.forEach(t=>{t.to==n&&(t.dose=Number(e))}):C.forEach((t,l)=>{o.push({dose:x[l]==n?Number(e):0,from:t,to:x[l]})});void 0!==s[l]&&(i[t]=o,s[l]=i,a.lsSet("doses",s))}(n[t],e,l,m)}),t.parentNode.className="hide",this.parentNode.parentNode.innerHTML+=y}else if(g){let e=t.nextElementSibling.options[t.nextElementSibling.selectedIndex].value;y=h(s,e,m),t.parentNode.parentNode.replaceChild((_=y,(v=document.createElement("div")).innerHTML=_.trim(),v.firstChild),t.parentNode)}var _,v}function h(e,t,n){let l=0===e;return`<span class="ins_type"\n                    ${l||!t?"":`data-css="${t[0].toUpperCase()}"`}\n                    ${t?`data-type=${t}`:""}\n                    data-time=${n}>${l?"":e}</span>`}function p(){let e="TD"!==this.nodeName?this:this.firstChild,t=e.parentNode,n=Number(e.textContent),l=e.dataset.type;a.insertInputWithSelect(e,n,l);let s=e.firstChild;return t.replaceChild(s,e),c(s)}function f(e){let t=e.target.textContent,n=a.lsGet("times"),l=n.indexOf(t),s=a.lsGet("doses");return confirm(i.deleteColumn)?(delete s[t],n.splice(l,1),e.target.parentNode.remove(),a.lsSet("doses",s),a.lsSet("times",n),y(t,l)):void 0}function g(e){let t=e.target,n=t.dataset.type,l=t.parentNode.parentNode.dataset.index,s=a.lsGet("times"),o=s[l],r=a.lsGet("doses"),d=i.deleteFromColumn.replace("%_%",n),u=i.deleted.replace("%_%",n);if(confirm(d))delete r[o][n],0===Object.keys(r[o]).length&&(delete r[o],s.splice(l,1),y(o,l),a.lsSet("times",s)),t.parentNode.remove(),document.querySelectorAll(`.ins_type[data-time="${o}"][data-type="${n}"]`).forEach(e=>e.remove()),a.handler.call(document.querySelector(".print"),u,!1),a.lsSet("doses",r);else{let e=h(t.parentNode.childNodes[1].value,n,o);t.parentNode.parentNode.innerHTML=e,t.parentNode.remove()}}function y(e,t){document.querySelector(`.inj_time[data-time="${e}"]`).remove(),document.querySelectorAll(`.doses[data-index="${t}"]`).forEach(e=>e.remove())}function _(e){let t=e.target,n=t.dataset.time;return a.insertInput(t,n),v(t.firstChild,n)}function v(e,t){e.addEventListener("keyup",n=>{let l,s=!1,r=e.parentNode,d=n.target.value,u=/^\d{1,2}:[0-5]\d$/,c=/^\d{1,2}$/,m=13===n.which,h=27===n.which;if(m)if(u.test(d)){d.split(":")[0]<=23?l=d:s=!0}else c.test(d)&&d<=23?l=`${d}:00`:s=!0;else h&&(r.innerHTML=t);if(s)a.handler.call(document.querySelector(".print"),i.invalidValue);else if(void 0!==l&&!s){return void 0!==a.lsGet("doses")[l]?a.handler.call(document.querySelector(".print"),i.exist.replace("%_%",l)):(r.dataset.time=l,r.innerHTML=l,function(e,t){let n=a.lsGet("doses")||{};if(void 0!==t){let l=n[t];n[e]=l,delete n[t]}else n[e]=a.lsGet("doses")[e]||{};return a.lsSet("times",Object.keys(n)),a.lsSet("doses",n),o(e)}(l,t))}})}e.addEventListener("click",u),t.addEventListener("submit",function(t){t.preventDefault(),e.removeAttribute("disabled");let n=t.target.firstChild.nextElementSibling,l=/^\w{3,}$/,s=n.value.toLowerCase(),o=a.lsGet("insulins");if(s&&l.test(s)&&!o.includes(s)){let e=o||[];return e.push(s),n.value="",a.lsSet("insulins",e),r(s)}{let e=s&&l.test(s)?i.exist.replace("%_%",s):i.invalidValue;return a.handler.call(document.querySelector("#insulin_add_form"),e)}}),n.addEventListener("mouseover",function(e){let t=e.target,n=t.className,l=t.nodeName;"inj_time"===n&&"TH"===l||("delete_dose"===n&&"BUTTON"===l?t.addEventListener("click",g,!0):"ins_type"===n&&"SPAN"===l&&t.addEventListener("click",p))});const k=document.querySelectorAll(".empty"),A=document.querySelectorAll(".fill");function b(e){e.dataTransfer.setData("text",e.target.id),this.classList.add("hold"),setTimeout(()=>this.classList.add("hide"))}function S(e){e.preventDefault()}function E(e){e.preventDefault();const t=document.getElementById(e.dataTransfer.getData("text")),n=t.parentNode,l=e.currentTarget.firstElementChild,s=a.lsGet("doses"),i={};e.currentTarget.replaceChild(t,l),n.appendChild(l),k.forEach(e=>{let t=e.firstElementChild.textContent;i[t]=s[t]}),a.lsSet("doses",i)}k.forEach(e=>{e.addEventListener("dragover",S),e.addEventListener("drop",E)}),A.forEach((e,t)=>{e.id=`index_${t}`,e.addEventListener("dragstart",b),e.addEventListener("dragend",e=>e.target.className="fill"),e.addEventListener("click",f)})}const C=document.querySelector(".print");if("/"===location.pathname||location.pathname.endsWith("index.html")){const e=document.querySelector(".add_row"),t=document.querySelector(".set_date"),n=document.querySelector(".modal"),l=document.querySelector("tbody"),s=document.querySelector(".save_btn"),o=document.querySelector(".load_btn"),r={mg:60,mmol:3.3},d={mg:460,mmol:25.5},u=document.querySelector(".langs"),c=document.querySelector("#sugar_convertor"),m=document.querySelector("#auto_save"),h=a.lsGet("settings");let f=new i;function x(e,t){let n=Number(this.firstChild.value)||Number(e),l=a.getCookie("_type"),s=a.lsGet("doses")[t],i={};Object.keys(s).forEach(e=>{if(void 0!==s[e]&&s[e].forEach(t=>{void 0!==k(t,n)&&(i[e]=k(t,n))}),n="mg"===l?Math.round(n):Number(n).toFixed(1),function(e,t,n,l){let a=Object.keys(t);e.innerHTML=`<span class="sugar_value">${n}</span> <br/>`,e.setAttribute("data-type",l),a.forEach(n=>{if(0!==t[n])return e.innerHTML+=` <span class="dose_value" data-css="${n[0].toUpperCase()}">${t[n]}</span>`})}(this,i,n,l),"true"==a.getCookie("_autoSave"))return w()})}function k(e,t){let n=e.from,l=e.to,s=e.dose,i=null;if((i="mg"===a.getCookie("_type")?t:A(t))<=l&&i>=n)return s}function A(e){return Math.round(18*e)}function N(e,t=null){let n=document.createElement("tr"),s=Array.prototype.slice.call(document.querySelectorAll(".inj_time")),i=document.createDocumentFragment(),o=0,r=t?t.length:s.length;n.title="Double click for delete row";for(let l=0;l<=r;l++){let r=document.createElement("td");0===l?(r.setAttribute("data-lang",a.getCookie("_lang")),r.className="date_time",r.textContent="string"==typeof e?e:f.getPrevDay()):(t?r.setAttribute("data-time",t[o]):s.forEach((e,t)=>{if(t===o){let t=e.getAttribute("data-time");r.setAttribute("data-time",t)}}),r.className="dose",r.setAttribute("data-index",o++),r.innerHTML='<input type="text">'),n.className="data",i.appendChild(r)}n.appendChild(i),n.addEventListener("dblclick",e=>{if("td"==e.target.localName)return e.target.parentNode.remove()}),l.appendChild(n),document.querySelectorAll(".dose").forEach(e=>{e.addEventListener("keyup",q),e.addEventListener("dblclick",$)})}function $(e){if("sugar_value"===e.target.className)return p(e.target)}function p(e){let t=Number(e.textContent||e.children[0].textContent),n=e.getAttribute("data-index")||e.parentNode.getAttribute("data-index"),l=e.getAttribute("data-time")||e.parentNode.getAttribute("data-time");return console.log(e),e.innerHTML=`<input type="text" data-time="${l}" value=${t} data-index="${n}">`}function q(e){let t=e.target,n=Number(t.value),l=e.target.parentNode.getAttribute("data-time")||t.getAttribute("data-time"),s=a.getCookie("_type");if(13===e.which&&n>=r[s]&&n<=d[s])x.call(this,n,l);else if(27===e.which)return this.innerHTML="<span></span>"}function w(){let e,t=document.querySelectorAll('tr[class="data"]'),n=[];document.querySelectorAll(".dose").forEach(t=>{e=void 0!==t.dataset.type?t.dataset.type:a.getCookie("_type")}),t.forEach(t=>{let l=Array.prototype.slice.call(t.children),a=l[0].textContent,s=[],i=[];document.querySelectorAll(".inj_time").forEach(e=>{i.push(e.dataset.time)}),l.map((e,t)=>{if(0!==t){let t=e.firstChild.nextSibling||e.firstChild;t&&t.previousElementSibling?s.push(t.previousElementSibling.textContent):t&&t.textContent?s.push(t.textContent):s.push("")}}),n.push({day:a,sugars:s}),localStorage.setItem("sugar",JSON.stringify(n)),localStorage.setItem("times",JSON.stringify(i)),localStorage.setItem("type",e)})}function L(){let e=this.options[this.selectedIndex].dataset.lang;return a.translate(e),a.setCookie("_lang",e,1),f.changeLang()}f.getNow(),t.addEventListener("click",function(e){e.preventDefault();const t=document.querySelector("#date").value,l=Number(document.querySelector("#durotation").value);if(l&&t&&l>0){let e=t.split("-"),a=`${e[1]} ${e[2]}, ${e[0]}`,s=f.setFromTo(a,l);s.forEach(e=>{let t=`${e.day} ${e.month}`;N(t)}),n.style.display="none"}}),e.addEventListener("click",N),s.addEventListener("click",w),o.addEventListener("click",function(){const t=JSON.parse(localStorage.getItem("sugar"));let n=[];t&&t.map(t=>{n.push(...t.sugars),function(t,n){const l=JSON.parse(localStorage.getItem("times")),s=localStorage.getItem("type");N(t,l);let i=document.querySelectorAll(".dose");document.querySelectorAll(".inj_time").forEach(e=>{let t=e.dataset.time;l.includes(t)||e.remove()}),e.setAttribute("disabled","disabled"),document.querySelector(".set_date").setAttribute("disabled","disabled"),Array.from(c.options).forEach(e=>{e.value===s&&e.setAttribute("selected","selected")}),a.setCookie("_type",s,1),n.forEach((e,t)=>{let n=i[t].dataset.time;x.call(i[t],e,n,s)})}(t.day,n)});this.setAttribute("disabled","disabled")}),u.addEventListener("change",L),c.addEventListener("change",function(){let e=this.options[this.selectedIndex].value,t=document.querySelectorAll(".dose");h.insulinType&&(0!==t.length&&t.forEach(t=>{let n=t.dataset.type,l=Number(t.firstChild.textContent);if(void 0!==n&&n!==e&&l){let a="mg"===n?function(e){return(e/18).toFixed(1)}(l):A(l);t.setAttribute("data-type",e),t.firstChild.textContent=a}}),h.insulinType=e,a.lsSet("settings",h),a.setCookie("_type",e,1))}),m.addEventListener("click",e=>e.target.checked?a.setCookie("_autoSave",!0,1):a.setCookie("_autoSave",!1,1)),function(){if(!a.lsGet("doses")||0===Object.keys(a.lsGet("doses")).length)return a.createModal("warning");let e=u.options[u.selectedIndex].getAttribute("data-lang"),t=a.lsGet("times"),n=c.options[c.selectedIndex].value,l=a.getCookie("_lang"),s=a.getCookie("_autoSave"),i=document.createDocumentFragment();function o(e){let n=e.target.dataset.time,l=t.indexOf(n);0===document.querySelectorAll(".data").length&&(t.splice(l,1),e.target.remove())}if(t.forEach((e,t)=>{let n=document.createElement("th");n.textContent=e,n.className="inj_time",n.setAttribute("data-index",t),n.setAttribute("data-time",e),n.title="Double click for delete column",i.appendChild(n)}),document.querySelector(".table_head").appendChild(i),document.querySelectorAll(".inj_time").forEach(e=>{e.addEventListener("dblclick",o)}),a.lsGet("settings")){let{lang:e,insulinType:t,autoSave:n}=a.lsGet("settings")}else{let t={lang:e,autoSave:!1,insulinType:n};a.lsSet("settings",t)}l?(Array.from(u.options).forEach(e=>{e.dataset.lang===l?e.setAttribute("selected","selected"):e.removeAttribute("selected")}),L.call(u)):a.setCookie("_lang",e,1),document.querySelector("html").lang=l||e,a.setCookie("_type",n,1),s?"true"==s?m.setAttribute("checked","checked"):m.removeAttribute("checked"):a.setCookie("_autoSave",m.checked,1)}()}a.print(C),a.reset()},function(e,t){}]);